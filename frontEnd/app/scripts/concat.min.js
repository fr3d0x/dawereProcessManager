"use strict";var app=angular.module("app",["ngCookies","picardy.fontawesome","ui.bootstrap","ui.router","ui.select","pascalprecht.translate","checklist-model","angular.filter","base64","ngRoute","config","LocalStorageModule","ngTable"]).run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c,a.$on("$stateChangeSuccess",function(b,c){b.targetScope.$watch("$viewContentLoaded",function(){angular.element("html, body, #content").animate({scrollTop:0},200),setTimeout(function(){angular.element("#wrap").css("visibility","visible"),angular.element(".dropdown").hasClass("open")||angular.element(".dropdown").find(">ul").slideUp()},200)}),a.containerClass=c.containerClass})}]).config(["uiSelectConfig",function(a){a.theme="bootstrap"}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"languages/",suffix:".json"}),a.useLocalStorage(),a.preferredLanguage("en")}]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/app/dashboard"),a.state("app",{url:"/app",controller:"appViewController",templateUrl:"views/app.html"}).state("core",{"abstract":!0,url:"/core",template:"<div ui-view></div>"}).state("core.login",{url:"/login",controller:"loginController",templateUrl:"views/login.html"}).state("app.dashboard",{url:"/dashboard",controller:"dashboardController",templateUrl:"views/dashboard/dashboard.html"}).state("app.subjects",{url:"/subjects",controller:"subjectListController",templateUrl:"views/sharedNavigation/subjectList.html"}).state("app.preProduction",{url:"/preProduction",template:"<div ui-view></div>"}).state("app.preProduction.classesPlanification",{url:"/classesPlanification?id",controller:"classesPlanificationController",templateUrl:"views/pre-produccion/classesPlanification.html"}).state("app.preProduction.editClassPlan",{url:"/editClassPlan?id",controller:"editClassPlanController",templateUrl:"views/pre-produccion/editClassPlan.html"})}]);app.service("dawProcessManagerService",["$http","localStorageService","ENV",function(a,b,c){var d=c.baseUrl;this.registerUser=function(a,b,c){},this.login=function(b,c,e){a.post(d+"/api/users/login",b).success(c).error(e)},this.countRoles=function(a,b,c){},this.getClassesPlaning=function(b,c,e){a.get(d+"/api/subject_planifications/getWholeSubjectPlanning?id="+b).success(c).error(e)},this.getSubjectsPlaning=function(b,c){a.get(d+"/api/subject_planifications/getSubjectsPlanning").success(b).error(c)},this.getGlobalProgress=function(b,c){a.get(d+"/api/users/globalProgress").success(b).error(c)}}]),app.factory("httpInterceptor",["localStorageService",function(a){return{request:function(b){return a.get("encodedToken")?(b.headers.Authorization=a.get("encodedToken"),b):b},responseError:function(a){return a}}}]),app.config(["$httpProvider",function(a){a.interceptors.push("httpInterceptor")}]),app.service("responseHandlingService",function(){this.evaluate=function(a,b){var c,d;switch(a){case"UNAUTHORIZED":c="NO AUTORIZADO",d="warning";break;case"FAILED":c="FALLIDO",d="warning";break;default:c="ERROR",d="error",b="Fallo de conexion"}swal(c,b,d)}}),app.controller("appViewController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService","$rootScope",function(a,b,c,d,e,f,g,h,i,j,k){d.get("encodedToken")?(null==k.currentUser&&(k.currentUser=d.get("currentUser")),null!=d.get("currentRole")&&(k.currentRole=d.get("currentRole"))):h.go("core.login")}]),app.controller("dashboardController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService",function(a,b,c,d,e,f,g,h,i,j){var k=JSON.parse(atob(d.get("encodedToken").split(".")[1]));if(null!=k&&null==d.get("currentRole"))for(var l=0;l<k.roles.length;l++)k.roles[l].primary&&(d.set("currentRole",k.roles[l].role),a.currentRole=k.roles[l].role)}]),app.controller("preProductionDashboardController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService","NgTableParams",function(a,b,c,d,e,f,g,h,i,j,k){var l=function(){c.getGlobalProgress(function(b){var c=b.data;a.tableParams=new k({},{filterOptions:{filterLayout:"horizontal"},dataset:c})},function(a){alert(a)})};l()}]),app.controller("loginController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService",function(a,b,c,d,e,f,g,h,i,j){a.user={},a.enviar=function(a){null==a.username||null==a.password||""==a.username||""==a.password?swal({title:"Aviso",text:"Por favor introduzca los datos pertinentes para iniciar sesion (Nombre de usuario y contrasena)",type:"error",confirmButtonColor:"#2A8F6D",cancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0}):k(a)};var k=function(a){c.login(a,function(a){if("SUCCESS"==a.status){var b=a.data;d.set("encodedToken",b),b=JSON.parse(atob(d.get("encodedToken").split(".")[1]));var c={};c.username=b.username,c.name=b.name,c.email=b.email,c.cedula=b.cedula,c.profile_picture=b.profile_picture,d.set("currentUser",c),null!=e.search().red?(g.location.href=f.decode(e.search().red),swal.close()):(swal.close(),h.go("app.dashboard"))}else j.evaluate(a.status,a.msg)},function(a){swal(a,"error")})}}]),app.controller("MainCtrl",["$scope","$http","localStorageService","$window","$state","$rootScope",function(a,b,c,d,e,f){}]),app.controller("classesPlanificationController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService","NgTableParams","$filter",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(){c.getClassesPlaning(i.id,function(b){var c=b.data;a.subject=c.subject,a.tableParams=new k({},{filterOptions:{filterLayout:"horizontal"},dataset:c.classesPlaning})},function(a){alert(a)})};m()}]),app.controller("editClassPlanController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService","NgTableParams","$filter",function(a,b,c,d,e,f,g,h,i,j,k,l){}]),app.controller("subjectPlannificationListController",["$scope","ENV","dawProcessManagerService","localStorageService","$location","$base64","$window","$state","$stateParams","responseHandlingService","NgTableParams","$filter",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(){c.getSubjectsPlaning(function(b){a.spList=b.data},function(a){alert(a)})};m()}]);